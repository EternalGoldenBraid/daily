{% extends "layout.html" %}

{% block title %}
	Daily

{% endblock %}

{% block main %}

	{% block content %}
		<h1> Hi, {{ current_user.username }}!</h1>
		
	{% endblock %}

 <table class="table">
  <thead class=.thead-dark>
    <tr>
      <th scope="col">Date</th>
      <th scope="col">Sleep</th>
      <th scope="col">Meditation</th>
      <th scope="col">Description</th>
      <th scope="col">Screens</th>
      <th scope="col">Rating</th>
      <th scope="col">Creative Work</th>
    </tr>
  </thead>
  <tbody>
	  <!-- Render per date in ratings table, join event_date==rating_date -->
		{% for i in rating%}
			<tr>
				<td scope="data"> {{i.date.strftime('%Y-%m-%d')}}</td>
				<td scope="data"> {{i.rating_sleep}}</td>
				<td scope="data"> {{i.meditation}}</td>
				<td scope="data">
					{% for r in rating_event %}
						{% if i.date==r.Event.rating_date %}
							{{r.Event.event_tag}}:{{r.Event.duration}},
						{% endif %}
					{% endfor %}
				</td>
				<td scope="data"> {{i.screen.strftime('%H:%M')}}</td>
				<td scope="data"> {{i.rating_day}}</td>
				<td scope="data"> {{i.cw}}</td>
    	</tr>             
		{% endfor %}
  </tbody>
</table>

<div class="form-container">
<h2> How was your day? </h2>

<div class="form-row">
  <form class= "form" "form-horizontal" action="" method="post" >
    {{ form_day.hidden_tag() }}
    <p>
  <!-- {{ form_day.date.label }} <br> -->
  {{ form_day.date(size=12) }}

<!-- {{ form_day.sleep_rating.label }} <br> -->
  {{ form_day.sleep_rating(size=3) }}

  <!-- {{ form_day.meditation.label }} <br> -->
	{{ form_day.meditation(size=7) }} 

  <!-- {{ form_day.day_rating.label }} <br> -->
	{{ form_day.day_rating(size=6) }} 

  <!-- {{ form_day.lights.label }} <br> -->
	{{ form_day.lights(size=5) }} 

  <!-- {{ form_day.cw.label }} <br> -->
	{{ form_day.cw(size=12) }} 
    </p>
		<p> {{ form_day.submit() }} </p> 
</div>

<!-- Confirm events and durations in a separate block Try 1 flaskwtf -->
	<script type=text/javascript>
		$(function() {
	  $('a#events_durations').bind('click', function() {
            alert("Wola"),
					$.getJSON($SCRIPT_ROOT + '/events_confirm', {
					  Event: $('input[name="event"]').val(),
						Duration: $('input[name="duration_event"]').val(),
					}, function(data) {
					  $("#result").text(data.result);
					});
					return false;
				  });

	</script>

  <div class="form-row">
    {{ form_events.hidden_tag() }}
		{{ form_events.event(size=20) }}
		{{ form_events.duration_event(size=20) }}
    <!-- <p> {{ form_events.submit(id=events_durations) }} </p> -->
  <p> <input id="eventsubmits" name="submit" type="submit" 
                value="Submit Events"> </p>
  </div>
<span id = result>"confirm"</span>


<script type=text/javascript>
  $(function() {
    $('#eventsubmits').bind('click', function() {
      $.getJSON($SCRIPT_ROOT + '/events_confirm', {
        Event: $('input[name="event"]').val(),
        Duration: $('input[name="duration_event"]').val()
      }, function(data) {
        $("#result").text(data.result);
      });
      return false;
    });
  });
</script>

{% endblock %}

<script type=text/javascript>
  $(function() {
    $('a#calculate').bind('click', function() {
            alert("Wola"),
      $.getJSON($SCRIPT_ROOT + '/events_confirm', {
        Event: $('input[name="a"]').val(),
        Duration: $('input[name="b"]').val()
      }, function(data) {
        $("#result").text(data.result);
      });
      return false;
    });
  });
</script>

<h1>jQuery Example</h1>
<p><input type=text size=5 name=a> +
   <input type=text size=5 name=b> =
   <span id=events_durations>?</span>








<div class="form-row"> 
  <!-- <p id="{{ form_events.description.id }}"> -->
	<p id="This">
  <!-- {{ form_events.description.label(bold) }} -->
	{{ form_events.description(size=80) }} </div>
  </p>
  <p> {{ form_events.submit(id='events_durations') }} </p>
</div>
<span id=result>Confirm_ here</span>



