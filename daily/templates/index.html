{% extends "layout.html" %}

{% block title %}
	Daily

{% endblock %}

{% block main %}

	{% block content %}
		<h1> Hi, {{ current_user.username }}!</h1>
		
	{% endblock %}


<div id='card'>
 <table id='events_all' class="table w-auto">
  <thead class=thead-light>
    <tr>
      <th scope="col">Date</th>
      <th scope="col">Sleep</th>
      <th scope="col">Meditation</th>
      <th scope="col">Description</th>
      <th scope="col">Screens</th>
      <th scope="col">Rating</th>
      <th scope="col">Creative Work</th>
			<th></th>
			<th></th>
    </tr>
  </thead>
  <tbody>
	  <!-- Render per date in ratings table, join event_date==rating_date -->
		{% for rating in ratings %}
			<tr>
				<td data-label='Date'> {{	rating.date.strftime('%Y-%m-%d') }}</td>
				<td data-label='Sleep'> {{	rating.rating_sleep }}</td>
				<td data-label='Meditation'> {{	rating.meditation }}</td>
				<td id='description' data-label='Description'>
					{% for event in rating.events %}
						{% for tag in event.tags %}
							{{ tag.tag_name.capitalize() }}:	
						{% endfor %}
					{{ event.story }} 
					{% if event.duration|string()|length != 0 %}
							: {{ event.duration }}
						{% endif %}
						<br>
					{% endfor %}
				</td>
				<td data-label='Screens'> {{ rating.screen }}</td>
				<td data-label'Rating'> {{ rating.rating_day }}</td>
				<td data-label='Creative Work'> {{ rating.cw }}</td>
				<td>
				<form action="{{url_for('delete_row', id=rating.id) }}" 
							method="post">
            <button type="hidden" name="_method" class="btn fa fa-trash" 
										value="DELETE_rating" id='deleteRowButton'>
            <button type="submit" value="EDIT_rating" class="btn fa fa-pencil"
						 			 id='editRowButton'>
          </form>
				</td>
    	</tr>             
		{% endfor %}
  </tbody>
</table>
</div>

<div id="newEntries" class="form-container">
<h2> How was your day? </h2>

<div class="align-items-center">
  <form id="mainform" class= "form form-horizontal" 
				action="" method="post" >
    {{ form_day.hidden_tag() }}
    <p>
		<div class="form-row">
			<div class="form-group col-auto">
	{{ form_day.date.label }} 
  {{ form_day.date(class="form-control", type="date", size=12) }}
			</div>

			<div class="form-group col-auto">
	{{ form_day.sleep_rating.label }} 
  {{ form_day.sleep_rating(class="form-control", type="number", size=3) }}
			</div>

			<div class="form-group col-auto">
				<div class="form-row">
	{{ form_day.meditation_hours.label }}
				</div>

				<div class="form-row">
	{{ form_day.meditation_hours(class="form-control", 
																	type="number", size=5) }}
	{{ form_day.meditation_minutes(class="form-control", type="number", 
																	size=5, value=30) }}
				</div>
			</div>

			<div class="form-group col-auto">
	{{ form_day.day_rating.label }}
	{{ form_day.day_rating(class="form-control", size=6) }} 
			</div>


			<div class="form-group col-auto">
	{{ form_day.lights.label }} 
	{{ form_day.lights(class="form-control", type="time", size=5) }} 
			</div>

			<div class="form-group col-auto">
	{{ form_day.cw_hours.label }}
	{{ form_day.cw_hours(class="form-control", type="number", size=5) }} 
	{{ form_day.cw_minutes(class="form-control", type="number", size=5) }} 
			</div>
		</div>
    </p>
		<p class="text-center" > {{ form_day.submit() }} </p>
	</div>
</div>


  <div class="form-group">
  		<div class="col-auto">
  	  {{ form_events.hidden_tag() }}

			{{ form_events.event.label }}
			{{ form_events.event(class="form-control form-control-lg",
														id="event_field") }}

			</div>

			{{ form_events.duration_event_hours.label }}
			{{ form_events.duration_event_hours(type="number", size=5) }}
			{{ form_events.duration_event_minutes(type="number", size=5) }}

  			<input id="eventsubmit" name="Submit" type="submit" 
								value="Add Event"> 
		</div>
  </div>
  			<input id="eventclear" name="Clear" type="submit" value="Clear">

	<!-- globals namespace -->
	<script type=text/javascript >
		var globals = {};
	</script>

  <!-- Events confirm -->
	<script type=text/javascript src="{{
		url_for('static', filename='js/confirmevents.js') }}"></script>

	<!-- Table control -->
	<script defer type=text/javascript src="{{
		url_for('static', filename='js/table_confirmation.js')  }}"></script>
	<script type=text/javascript src="{{
		url_for('static', filename='js/empty_confirmations.js') }}"></script>

  <!-- Edit and remove buffer -->
	<script type=text/javascript src="{{
		url_for('static', filename='js/edit_remove.js') }}"></script>

	<!-- Table generated for tag:story confirmation-->
<body>
	<div class=table-responsive">
<table id="confirmevents" class= "table table-sm">
	{% if events|length != 0 %}
        {% for entry in events %}
            <tr>
              <td scope=""> {{ entry }}</td>
              <td scope=""> {{ events[entry][0] }}</td>
							<td scope="">
                    <form id="buffer_buttons">
	        					    <button type="submit" class="btn fa fa-trash" 
                                name="DELETE_buffer" 
                                data-idx={{ events[entry][1]|tojson }}
                                id='DeleteBufferButton'>
                          <button type="" 
                                class="btn fa fa-pencil" 
                                id='EditBufferButton'>
	        					</form>
            </tr>
        {% endfor %}
	</table>
	{% endif %}
	</body>
	</div>
        
{% endblock %}

<!--
 <table class="table table-sm">
  <thead class=.thead-dark>
    <tr>
      <th scope="col">Event</th>
      <th scope="col">Duration</th>
    </tr>
  </thead>
  <tbody>
	  <!-- Render per date in ratings table, join event_date==rating_date -->
		{% for entry in event %}
			<tr>
				<td scope="data"> {{ event }}</td>
				<td scope="data"> {{ duration }}</td>
    	</tr>             
		{% endfor %}
  </tbody>
</table>
-->
